%!TEX root = dippa.tex
%%% This file contains the results section of my master's thesis.
%%% Author: Viljami Aittomäki

\section{Results}

\begin{itemize}
  \item cross-validation results
  \begin{itemize}
    \item example plots of search path ("good" and "bad")
  \end{itemize}
  \item miRNA coefficients from final models (only a few of these!)
  \begin{itemize}
  	\item plot of different threshold values
    \item number of miRNAs included
    \item percentage of significant coefs
    \item number of negative miRNA coefs vs positive
    \item number of negative mRNA coefs
    \item percentage predicted by seq algos (num miRNAs vs num algos, included vs significant)
    \item percentage validated in experiments (included vs significant, mirTarBase)
    \item number of validated targets in PPVS vs Lasso vs GenMiR equiv (jos ehtii, tää olis kyllä mielenkiintonen), also num implicated in BRCA
    \item median of miRNA coef vs variance/prob.weight (sum of dens<0 or >0)
    \item magnitude of chosen miRNA coefs vs gene and constant
    \item posterior mean vs sd scatter (järkevä?)
  \end{itemize}
  \item Comparison with Lasso
  \begin{itemize}
    \item number of validated targets predicted
    \item number of validated targets missed
    \item scatter of common coefs
  \end{itemize}
  \item simple network analysis?
\end{itemize}

\subsection{Quality control}

Quality-control plots are presented in Appendix \ref{app:qc-plots}. Two
observations are worth noting. First, several genes have significant outliers
in the protein data (most notably the genes CDK1, ERRFI1, PIK3CA). This is
most apparent in the scaled data. Second, the miRNA microarrays have bimodal
distributions, and many miRNA variables are highly skewed towards very small
values. This is indicative of the generally low abundances of some miRNA molecules
and, although partly due to different preprocessing compared to the mRNA and
protein arrays, it raises suspicion of significant noise in the miRNA data.
The raw array data produced from Agilent array readers was not assessed here.

The first two principal components for each data type were plotted and are
shown in Figure \ref{fig:pca}. No significant batch effect is visible. The
hierarchical clustering of samples (not shown) had a similar result.


\subsection{Correlation analysis}

Pearson correlations between variables from the different datatypes are shown in Figure
\ref{fig:correlations}. Protein-mRNA correlation is clearly higher for gene-matched pairs
(that is protein and mRNA expression corresponding to the same gene), and for
unmathced pairs correlations are concentrated around zero, both expected
results. Notable, even the gene-matched correlations are quite low, with a
mean $\bar{\rho} \approx 0.37$ and roughly 67\% of genes having $\rho < 0.5$, and
some having negative correlation. This is in alignment with earlier results. 

\begin{figure}[!h]
  \centering
  \begin{subfigure}{.45\textwidth}
    \centering
    \includegraphics[width=1\linewidth]{figures/correlationPlots/protein-gene-correlation.pdf}
    \subcaption{ \label{fig:protein-gene-cor}}
  \end{subfigure}
  \begin{subfigure}{.45\textwidth}
    \centering
    \includegraphics[width=1\linewidth]{figures/correlationPlots/protein-mirna-correlation.pdf}
    \subcaption{ \label{fig:protein-mirna-cor}}
  \end{subfigure}
  \begin{subfigure}{.45\textwidth}
    %\centering
    \includegraphics[width=1\linewidth]{figures/correlationPlots/gene-mirna-correlation.pdf}
    \subcaption{ \label{fig:gene-mirna-cor}}
  \end{subfigure}

  \caption{Distributions of Pearson correlations between variables of different expression data types.
  The distributions are trimmed at the smallest and largest values.
  (a) Correlation between protein and mRNA pairs, where "matched" refers to correlating
  protein and mRNA from the same gene. (b) Correlation between protein and miRNA pairs,
  where "validated" refers to the gene being a validated target of the miRNA, and
  "random" to a randomly picked group of protein-miRNA pairs.
  (c) Correlation between mRNA and miRNA pairs,
  where "validated" refers to the gene being a validated target of the miRNA, and
  "random" to a randomly picked group of miRNA-mRNA pairs.}
  \label{fig:correlations}
\end{figure}

Correlations between miRNAs and their validated target genes are mostly low
with no preference towards negative (or positive) values. There is virtually
no difference in correlations between validated targets and randomly picked
gene-miRNA pairs, contrary to what might be expected. This suggests that
(Pearson) correlation of expression data is not a suitable method for finding
miRNA targets.


\subsection{Variable selection}

All parameters for all simulations had $\hat{R}^2 < 1.1$, indicating
good convergence of simulation chains \citep{Gelman2013}.

Figure \ref{n-miRNAs-vs-R2} shows the number of miRNA variables included in
each projected model plotted against the number of significant miRNA
variables, the $R^2$ of the projected model, and the difference in $\bar{R}^2$
between the projected model and the gene-only model. Each point in each plot
corresponds to one  model, and smoothed curves were fitted using locally
weighted scatter plot smoothing (LOESS). A trend emerges, where including more
miRNA variables tends to achieve better performance up to a turning point --
around 28 miRNA variables -- after which larger models seem to perform
increasingly poorly. Similar plots were created with more strict model-size
thresholds ($\gamma$ and $\alpha$); the models were larger on
average, but an equal trend and turning point were observed (data not shown).

\begin{figure}[htb]
  \centering
  \includegraphics[height=11cm]{n_miRNAs_vs_R2.pdf}
  \caption{Size of final model compared to model goodness-of-fit. Plotted is the total number of chosen miRNA variables in each full model (N miRNAs) versus number of significant miRNA variables, R$^2$ of full model, and difference of $\bar{R}^2$ between full and gene only model ($\Delta\bar{R}^2$). Each point represents one model fitted for one gene. Note that some points are overlaid. Curves were fitted with locally weighted scatter plot smoothing (LOESS) and shaded areas represent 95\% confidence interval. \label{n-miRNAs-vs-R2}}
\end{figure}

There could be several explanations for this trend. Firstly, the largest
models could simply be a result of the predictors not fitting the observed
variable well. This can result in a large model, because including more
predictors often makes the model fit asymptotically better -- both in the
sense of $R^2$ and generally also the predictive density, which was used as
the measure of fit for the variable-selection process. From a biological
perspective, this means that the mRNA and miRNA expression are not sufficient
to explain the protein expression; other factors, that the model does not
account for (e.g. protein degradation), possibly dominate.
Secondly, the marginal posterior of a single predictor can indicate
non-significance, while the joint posterior of several predictors combined
might still achieve significance. This would indicate that the effect of
miRNAs is only significant when acting simultaneosly, a hypothesis that is
supported by experimental evidence, as discussed in section
\ref{microrna-function}.

A table of properties for the projected models is available in Appendix
\ref{app:full-model-table}.


\subsubsection{Comparison to lasso regression}

Number of validated targets predicted and missed for both. (Also compare
to seq-based prediction if time).

\begin{figure}[htb]
  \centering
  \includegraphics[width=.6\linewidth]{figures/compareModels/Venn_PPVS-sig_Lasso.pdf}
  \caption{Venn diagram showing the overlap of predicted miRNA targets
  between projection prediction (PPVS) and lasso regression.}
  \label{fig:venn-ppvs-lasso}
\end{figure}

\begin{figure}[htb]
  \centering
  \includegraphics[width=.6\linewidth]{figures/compareModels/PPVS_Lasso_coef_scatter.pdf}
  \caption{Scatter plot of miRNA regression coefficients from projection
  prediction (PPVS) and lasso for the 145 common targets predicted by both methods.
  Note that PPVS coefficients generally have greater magnitude. The gray
  line marks unity ($x=y$).}
  \label{fig:scatter-ppvs-lasso}
\end{figure}

Projection was clearly better?
